@using Tourism.ViewModel
@model AdminDashboardViewModel
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Admin Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body {
            background-color: #f8f9fa;
        }

        h1 {
            text-align: center;
            margin-top: 30px;
            font-weight: 600;
            color: #333;
        }

        /* Sidebar */
        .sidebar {
            height: 100vh;
            position: fixed;
            left: -260px;
            top: 0;
            width: 250px;
            background-color: #0d6efd;
            padding-top: 60px;
            color: white;
            transition: left 0.3s ease;
            z-index: 1050;
        }

            .sidebar.open {
                left: 0;
            }

            .sidebar a {
                display: block;
                padding: 12px 20px;
                color: white;
                text-decoration: none;
                font-weight: 500;
            }

                .sidebar a:hover {
                    background-color: rgba(255, 255, 255, 0.1);
                    border-radius: 6px;
                }

        /* Overlay to dim background */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            height: 100%;
            width: 100%;
            background-color: rgba(0,0,0,0.4);
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease;
            z-index: 1040;
        }

            .overlay.show {
                opacity: 1;
                visibility: visible;
            }

        /* Toggle button */
        .sidebar-toggle {
            position: fixed;
            left: 10px;
            top: 10px;
            z-index: 1060;
            background-color: #0d6efd;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
        }

        /* Cards */
        .small-card {
            width: 13rem;
            height: 17rem;
            margin: auto;
            border: none;
            border-radius: 12px;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

            .small-card:hover {
                transform: translateY(-5px);
                box-shadow: 0 8px 18px rgba(0, 0, 0, 0.15);
            }

        .fixed-img {
            height: 90px;
            object-fit: contain;
            padding: 10px;
            margin-top: 10px;
        }

        .card-body {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .card-title {
            font-weight: 600;
            color: #0d6efd;
            margin-bottom: 0.5rem;
            font-size: 1rem;
        }

        .card-text {
            font-size: 2.8rem;
            font-weight: 700;
            color: #000;
            margin: 0;
        }

        .row.justify-content-center {
            display: flex;
            flex-wrap: wrap;
            gap: 2rem;
        }

        canvas {
            max-width: 400px;
            max-height: 400px;
        }
    </style>
</head>

<body>
    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <h5 class="text-center mb-4">Admin Menu</h5>
        <a asp-action="VerificationRequests" asp-controller="Admin" asp-route-type="Merchant">Merchant Verification Requests</a>
        <a asp-action="ServiceRequests" asp-controller="Admin" asp-route-type="Merchant">Merchant Product Requests</a>
        <a href="#">Hotel Verification Requests</a>
        <a href="#">Hotel Product Requests</a>
        <a href="#">Tour Guide Verification Requests</a>
        <a href="#">Tour Guide Product Requests</a>
        <a href="#">Restaurant Verification Requests</a>
        <a href="#">Restaurant Product Requests</a>
    </div>

    <!-- Overlay -->
    <div class="overlay" id="overlay"></div>

    <!-- Sidebar Toggle Button -->
    <button class="sidebar-toggle" id="sidebarToggle">☰</button>

    <!-- Main content -->
    <div class="content">
        <!-- Navbar -->
        <nav class="navbar navbar-expand-lg bg-body-tertiary shadow-sm mb-4">
            <div class="container-fluid">
                <a class="navbar-brand text-primary" href="#">Tourism</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                        data-bs-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup"
                        aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <div class="collapse navbar-collapse justify-content-end" id="navbarNavAltMarkup">
                    <div class="navbar-nav">
                        <a class="nav-link active" href="#">Inbox</a>
                        <a class="nav-link" href="#">Help</a>
                        <a class="nav-link text-danger" asp-action="Logout" asp-controller="Admin">Log Out</a>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Header -->
        <h1>Welcome, Admin</h1>

        <!-- Action Cards -->
        <div class="container mt-4">
            <div class="row justify-content-center g-3">
                <a href="#" class="col-md-2 text-decoration-none text-dark">
                    <div class="card small-card text-center shadow-sm">
                        <img src="~/pics/Tourist.png" class="card-img-top fixed-img" alt="Tourists">
                        <div class="card-body">
                            <h6 class="card-title">Tourists</h6>
                            <p class="card-text">@Model.touristsCount</p>
                        </div>
                    </div>
                </a>

                <a href="#" class="col-md-2 text-decoration-none text-dark">
                    <div class="card small-card text-center shadow-sm">
                        <img src="~/pics/Merchant.png" class="card-img-top fixed-img" alt="Merchants">
                        <div class="card-body">
                            <h6 class="card-title">Merchants</h6>
                            <p class="card-text">@Model.merchantsCount</p>
                        </div>
                    </div>
                </a>

                <a href="#" class="col-md-2 text-decoration-none text-dark">
                    <div class="card small-card text-center shadow-sm">
                        <img src="~/pics/Hotel.png" class="card-img-top fixed-img" alt="Hotels">
                        <div class="card-body">
                            <h6 class="card-title">Hotels</h6>
                            <p class="card-text">@Model.hotelsCount</p>
                        </div>
                    </div>
                </a>

                <a href="#" class="col-md-2 text-decoration-none text-dark">
                    <div class="card small-card text-center shadow-sm">
                        <img src="~/pics/Restaurant.png" class="card-img-top fixed-img" alt="Restaurants">
                        <div class="card-body">
                            <h6 class="card-title">Restaurants</h6>
                            <p class="card-text">@Model.restaurantsCount</p>
                        </div>
                    </div>
                </a>

                <a href="#" class="col-md-2 text-decoration-none text-dark">
                    <div class="card small-card text-center shadow-sm">
                        <img src="~/pics/TourGuide.png" class="card-img-top fixed-img" alt="Tour Guides">
                        <div class="card-body">
                            <h6 class="card-title">Tour Guides</h6>
                            <p class="card-text">@Model.tourGuidesCount</p>
                        </div>
                    </div>
                </a>
            </div>
        </div>

        <!-- Earnings Pie Chart -->
        <div class="container mt-5 mb-5">
            <h3 class="text-center mb-4 text-primary">Earnings Breakdown</h3>
            <div class="d-flex justify-content-center">
                <canvas id="earningsChart" width="400" height="400"></canvas>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
        const sidebar = document.getElementById('sidebar');
        const overlay = document.getElementById('overlay');
        const toggleBtn = document.getElementById('sidebarToggle');

        toggleBtn.addEventListener('click', () => {
            sidebar.classList.toggle('open');
            overlay.classList.toggle('show');
        });

        overlay.addEventListener('click', () => {
            sidebar.classList.remove('open');
            overlay.classList.remove('show');
        });

        // === Earnings Pie Chart ===
        const ctx = document.getElementById('earningsChart').getContext('2d');

        const earningsChart = new Chart(ctx, {
            type: 'pie',
            data: {
                labels: ['E-commerce', 'Trips', 'Restaurants', 'Hotels'],
                datasets: [{
                    label: 'Earnings (EGP)',
                    data: [
        @Model.earningsFromEcommerce,
        @Model.earningsFromTrips,
        @Model.earningsFromRestaurants,
        @Model.earningsFromHotels
                    ],
                    backgroundColor: [
                        'rgba(13, 110, 253, 0.7)',  // Blue
                        'rgba(25, 135, 84, 0.7)',   // Green
                        'rgba(255, 193, 7, 0.7)',   // Yellow
                        'rgba(220, 53, 69, 0.7)'    // Red
                    ],
                    borderColor: [
                        'rgba(13, 110, 253, 1)',
                        'rgba(25, 135, 84, 1)',
                        'rgba(255, 193, 7, 1)',
                        'rgba(220, 53, 69, 1)'
                    ],
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: {
                            font: {
                                size: 14
                            }
                        }
                    },
                    title: {
                        display: true,
                        text: 'Earnings Distribution',
                        font: {
                            size: 18,
                            weight: 'bold'
                        }
                    }
                }
            }
        });
    </script>
</body>
</html>
